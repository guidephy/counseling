<!doctype html>
<html>
<head>

    <script src=jquery-2.2.4.min.js></script>
    <script src="https://code.jquery.com/jquery-1.9.1.js"></script>
    <meta charset="utf-8">
    <title>觀音高中諮商室借用系統</title>

    <script>
   var parameter = {};
   var datedata;
   var i=1;

    $.get("https://script.google.com/macros/s/AKfycbxu3TT3FCo430Dcdtnx27oC9PTVUlO0x9RTBw558WtMeUfER10/exec", parameter, function(data) {
        
            datedata=data.split(",");
             
        
      });  


    </script>
 
</head>
    
    
<body>
<h2 align="center" style="color:blue;">觀音高中諮商室借用系統</h2>

    <div id="password" align="center">
    <input type="password"  style="text-align:center;" id="passcode" placeholder="請輸入密碼"><button id="sendBtn" onclick="send()">送出</button>
    </div>

<div id="tabledata" style='visibility:hidden'>
    <h4>&nbsp&nbsp使用學生班級:<input id="class" placeholder="請輸入學生班級">&nbsp&nbsp老師:<input id="name" placeholder="請輸入老師名字">
    <table border="1" align="center" style="width:100%"  >
　       <tr style="background-color:yellow">
　           <td colspan="12" align="center"><button id="backBtn"  onclick="back()">上一週</button>&nbsp&nbsp<<&nbsp&nbsp第<span id="week"></span>週&nbsp&nbsp>>&nbsp&nbsp<button id="nextBtn"  onclick="next()">下一週</button></td>
　       </tr>

 <tr align="center" valign="middle" style="background-color:yellow">
    <td  style="width:6%">日期</td>
　   <td  style="width:6%">教室\節次</td>
    <td  style="width:9%">&nbsp1&nbsp</td>
    <td  style="width:9%">&nbsp2&nbsp</td>
    <td  style="width:9%">&nbsp3&nbsp</td>
    <td  style="width:9%">&nbsp4&nbsp</td>
    <td  style="width:9%">午休</td>
    <td  style="width:9%">&nbsp5&nbsp</td>
    <td  style="width:9%">&nbsp6&nbsp</td>
    <td  style="width:9%">&nbsp7&nbsp</td>
    <td  style="width:9%">&nbsp8&nbsp</td>
    <td  style="width:7%">晚上</td>

　</tr>

 <tr align="center">
　<td rowspan="4"style="background-color:yellow" ><br><span id="monday"></span><br>(一)<br></td>
　<td style="background-color:pink" >個諮1</td>
    <td  ><input type="button" id="(2,2)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,3)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,4)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,5)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,6)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,7)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,8)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,9)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,10)" value="登記" onclick="writeData(this)"></td>
    <td  ><input type="button" id="(2,11)" value="登記" onclick="writeData(this)"></td>
　</tr>
　<tr align="center">
　<td style="background-color:pink">個諮2</td>
    <td  ><input type="button" id="(2,12)" value="登記"></td>
    <td  ><input type="button" id="(2,13)" value="登記"></td>
    <td  ><input type="button" id="(2,14)" value="登記"></td>
    <td  ><input type="button" id="(2,15)" value="登記"></td>
    <td  ><input type="button" id="(2,16)" value="登記"></td>
    <td  ><input type="button" id="(2,17)" value="登記"></td>
    <td  ><input type="button" id="(2,18)" value="登記"></td>
    <td  ><input type="button" id="(2,19)" value="登記"></td>
    <td  ><input type="button" id="(2,20)" value="登記"></td>
    <td  ><input type="button" id="(2,21)" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">團諮3</td>
    <td  ><input type="button" id="(2,22)" value="登記"></td>
    <td  ><input type="button" id="(2,23)" value="登記"></td>
    <td  ><input type="button" id="(2,24)" value="登記"></td>
    <td  ><input type="button" id="(2,25)" value="登記"></td>
    <td  ><input type="button" id="(2,26)" value="登記"></td>
    <td  ><input type="button" id="(2,27)" value="登記"></td>
    <td  ><input type="button" id="(2,28)" value="登記"></td>
    <td  ><input type="button" id="(2,29)" value="登記"></td>
    <td  ><input type="button" id="(2,30)" value="登記"></td>
    <td  ><input type="button" id="(2,31)" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">905</td>
    <td  ><input type="button" id="(2,32)" value="登記"></td>
    <td  ><input type="button" id="(2,33)" value="登記"></td>
    <td  ><input type="button" id="(2,34)" value="登記"></td>
    <td  ><input type="button" id="(2,35)" value="登記"></td>
    <td  ><input type="button" id="(2,36)" value="登記"></td>
    <td  ><input type="button" id="(2,37)" value="登記"></td>
    <td  ><input type="button" id="(2,38)" value="登記"></td>
    <td  ><input type="button" id="(2,39)" value="登記"></td>
    <td  ><input type="button" id="(2,40)" value="登記"></td>
    <td  ><input type="button" id="(2,41)" value="登記"></td>
　</tr>

 <tr align="center">
　<td rowspan="4" style="background-color:yellow"><br><span id="tuesday"></span><br>(二)<br></td>
 <td style="background-color:pink">個諮1</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
　<tr align="center">
　<td style="background-color:pink">個諮2</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">團諮3</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
    
   <tr align="center">
　<td style="background-color:pink">905</td>
    <td  ><input type="button" id="(2,32)" value="登記"></td>
    <td  ><input type="button" id="(2,33)" value="登記"></td>
    <td  ><input type="button" id="(2,34)" value="登記"></td>
    <td  ><input type="button" id="(2,35)" value="登記"></td>
    <td  ><input type="button" id="(2,36)" value="登記"></td>
    <td  ><input type="button" id="(2,37)" value="登記"></td>
    <td  ><input type="button" id="(2,38)" value="登記"></td>
    <td  ><input type="button" id="(2,39)" value="登記"></td>
    <td  ><input type="button" id="(2,40)" value="登記"></td>
    <td  ><input type="button" id="(2,41)" value="登記"></td>
　</tr>

 <tr align="center">
　<td rowspan="4" style="background-color:yellow"><br><span id="wednesday"></span><br>(三)<br></td>
　<td style="background-color:pink">個諮1</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
　<tr align="center">
　<td style="background-color:pink">個諮2</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">團諮3</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
     
    <tr align="center">
　  <td style="background-color:pink">905</td>
    <td  ><input type="button" id="(2,32)" value="登記"></td>
    <td  ><input type="button" id="(2,33)" value="登記"></td>
    <td  ><input type="button" id="(2,34)" value="登記"></td>
    <td  ><input type="button" id="(2,35)" value="登記"></td>
    <td  ><input type="button" id="(2,36)" value="登記"></td>
    <td  ><input type="button" id="(2,37)" value="登記"></td>
    <td  ><input type="button" id="(2,38)" value="登記"></td>
    <td  ><input type="button" id="(2,39)" value="登記"></td>
    <td  ><input type="button" id="(2,40)" value="登記"></td>
    <td  ><input type="button" id="(2,41)" value="登記"></td>
　</tr>

 <tr align="center">
　<td rowspan="4" style="background-color:yellow"><br><span id="thursday"></span><br>(四)<br></td>
　<td style="background-color:pink">個諮1</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　<tr align="center">
　<td style="background-color:pink">個諮2</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">團諮3</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　  </tr>
        
    <tr align="center">
 　 <td style="background-color:pink">905</td>
    <td  ><input type="button" id="(2,32)" value="登記"></td>
    <td  ><input type="button" id="(2,33)" value="登記"></td>
    <td  ><input type="button" id="(2,34)" value="登記"></td>
    <td  ><input type="button" id="(2,35)" value="登記"></td>
    <td  ><input type="button" id="(2,36)" value="登記"></td>
    <td  ><input type="button" id="(2,37)" value="登記"></td>
    <td  ><input type="button" id="(2,38)" value="登記"></td>
    <td  ><input type="button" id="(2,39)" value="登記"></td>
    <td  ><input type="button" id="(2,40)" value="登記"></td>
    <td  ><input type="button" id="(2,41)" value="登記"></td>
　</tr>     
        

 <tr align="center">
　<td rowspan="4" style="background-color:yellow"><br><span id="friday"></span><br>(五)<br></td>
　<td style="background-color:pink">個諮1</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
　<tr align="center">
　<td style="background-color:pink">個諮2</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>
 <tr align="center">
　<td style="background-color:pink">團諮3</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　</tr>

   <tr align="center">
　 <td rowspan="4" style="background-color:yellow"><br><span id="saturday"></span><br>(六)<br></td>
　 <td style="background-color:pink">個諮1</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　  <tr align="center">
　  <td style="background-color:pink">個諮2</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
  　</tr>
    <tr align="center">
　  <td style="background-color:pink">團諮3</td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
    <td  ><input type="button" value="登記"></td>
　  </tr>
  
    <tr align="center">
　  <td style="background-color:pink">905</td>
    <td  ><input type="button" id="(2,32)" value="登記"></td>
    <td  ><input type="button" id="(2,33)" value="登記"></td>
    <td  ><input type="button" id="(2,34)" value="登記"></td>
    <td  ><input type="button" id="(2,35)" value="登記"></td>
    <td  ><input type="button" id="(2,36)" value="登記"></td>
    <td  ><input type="button" id="(2,37)" value="登記"></td>
    <td  ><input type="button" id="(2,38)" value="登記"></td>
    <td  ><input type="button" id="(2,39)" value="登記"></td>
    <td  ><input type="button" id="(2,40)" value="登記"></td>
    <td  ><input type="button" id="(2,41)" value="登記"></td>
  　</tr>
        
        
        
</table>
</div>

    
<script>
    


     setTimeout(function(){   
        i=(datedata[0]-1)*7+1;
        document.getElementById("week").innerHTML=(i-1)/7+1; 
        document.getElementById("monday").innerHTML=datedata[i]; 
        document.getElementById("tuesday").innerHTML=datedata[i+1]; 
        document.getElementById("wednesday").innerHTML=datedata[i+2]; 
        document.getElementById("thursday").innerHTML=datedata[i+3]; 
        document.getElementById("friday").innerHTML=datedata[i+4]; 
        document.getElementById("saturday").innerHTML=datedata[i+5]; 


     }, 4000);
    
  
    


function send(){
if (document.getElementById("passcode").value=="123456") {
     document.getElementById("password").remove();
     document.getElementById("tabledata").style.visibility='visible';
}else{
alert("密碼錯誤!")
};

}

function next(){
    if(i<147){

        i=i+7;
        document.getElementById("week").innerHTML=(i-1)/7+1; 
        document.getElementById("monday").innerHTML=datedata[i]; 
        document.getElementById("tuesday").innerHTML=datedata[i+1]; 
        document.getElementById("wednesday").innerHTML=datedata[i+2]; 
        document.getElementById("thursday").innerHTML=datedata[i+3]; 
        document.getElementById("friday").innerHTML=datedata[i+4]; 
        document.getElementById("saturday").innerHTML=datedata[i+5]; 
     };

    }

function back(){
    if(i>1){

        i=i-7;
        document.getElementById("week").innerHTML=(i-1)/7+1; 
        document.getElementById("monday").innerHTML=datedata[i]; 
        document.getElementById("tuesday").innerHTML=datedata[i+1]; 
        document.getElementById("wednesday").innerHTML=datedata[i+2]; 
        document.getElementById("thursday").innerHTML=datedata[i+3]; 
        document.getElementById("friday").innerHTML=datedata[i+4]; 
        document.getElementById("saturday").innerHTML=datedata[i+5]; 
    }

    }


function writeData(abc){

if(abc.value=="登記"&&document.getElementById("name").value){    
abc.value=document.getElementById("class").value+"  "+document.getElementById("name").value;
abc.style.color = 'blue';

alert("登記完成");
}else if(abc.value==document.getElementById("class").value+"  "+document.getElementById("name").value){
    abc.value="登記";
    alert("已取消登記");
    abc.style.color = 'black';
}
}
  
    

</script>


</body>
</html>
